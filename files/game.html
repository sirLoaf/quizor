<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loris Maria Spiili</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        #question {
            font-size: 30px;
            margin-bottom: 20px;
        }
        .answers-list {
            list-style-type: none;
            padding: 0;
            font-size: 22px;
            margin: 0 auto;
            width: 50%;
        }
        .answer-item {
            padding: 10px;
            border: 2px solid #000;
            margin: 5px;
            visibility: hidden;
            background-color: #e7f1ff;
            border-radius: 5px;
            transition: visibility 0.5s, background-color 0.5s, transform 0.3s;
            display: flex;
            justify-content: space-between;
        }

        .revealed {
            visibility: visible !important;
            transform: scale(1.05);
        }

        .team1-color {
            background-color: #ffcccb; /* Light red for Team 1 */
        }

        .team2-color {
            background-color: #add8e6; /* Light blue for Team 2 */
        }

        .count {
            font-weight: bold;
            color: #000;
            text-align: right;
            min-width: 50px;
        }

        /* Team Info Section - Positioning at the top corners */
        #team-info {
            position: absolute;
            width: 100%;
            top: 0;
        }

        #team1-info {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            padding: 10px;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: #ffcccb; /* Light red */
        }

        #team2-info {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            padding: 10px;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: #add8e6; /* Light blue */
        }

        .team-points {
            font-weight: bold;
            color: #388e3c;
        }
        .team-x-count {
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body>
    <div id="game-screen">
        <h1>Fraage-Spiel</h1>
        <div id="question">Mir warted na ufd Fraage...</div>
        
        <ul id="answers" class="answers-list"></ul>

        <!-- Team Info Section -->
        <div id="team-info">
            <div id="team1-info">
                Team 1: Warte uf de Name... | <span class="team-points">Pünkt: 0</span> | <span class="team-x-count">X's: 0</span>
            </div>
            <div id="team2-info">
                Team 2: Warte uf de Name... | <span class="team-points">Pünkt: 0</span> | <span class="team-x-count">X's: 0</span>
            </div>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            const socket = io();

            // Function to display the question and answers
            function displayQuestionAndAnswers(data) {
                document.getElementById('question').innerText = data.question;
                
                // Clear any previous answers
                document.getElementById('answers').innerHTML = '';

                // Create answer placeholders
                data.answers.forEach((answer) => {
                    const li = document.createElement('li');
                    li.classList.add('answer-item');
                    li.innerHTML = `<span>${answer.text}</span> <span class="count" style="display:none;">(${answer.count})</span>`;
                    li.setAttribute('data-answer', answer.text);
                    document.getElementById('answers').appendChild(li);
                });
            }

            // Listen for the start of the game
            socket.on('startGame', (data) => {
                displayQuestionAndAnswers(data); // Display the first question and answers
            });

            // Listen for the next question
            socket.on('nextQuestion', (data) => {
                displayQuestionAndAnswers(data); // Display the new question and answers
            });

            // Listen for answers to be revealed and color them based on the team
            socket.on('revealAnswer', (answerData) => {
                const { answerText, team } = answerData;
                const answerItems = document.querySelectorAll('.answer-item');
                
                answerItems.forEach(item => {
                    const dataAnswer = item.getAttribute('data-answer').trim().toLowerCase();
                    const cleanedAnswerText = answerText.trim().toLowerCase();
                    
                    if (dataAnswer === cleanedAnswerText) {
                        item.classList.add('revealed');
                        
                        // Color the revealed answer based on the team
                        if (team === 'Team 1') {
                            item.classList.add('team1-color');
                        } else if (team === 'Team 2') {
                            item.classList.add('team2-color');
                        }

                        const countElement = item.querySelector('.count');
                        countElement.style.display = 'inline';  // Show the count when the answer is revealed
                    }
                });
            });

            // Listen for wrong answers (X's)
            socket.on('updateX', (teamData) => {
                const teamElement = teamData.teamName === 'Team 1' ? document.getElementById('team1-info') : document.getElementById('team2-info');
                teamElement.querySelector('.team-x-count').innerText = `X's: ${teamData.xCount}`;
            });

            // Update team info with team names and points
            socket.on('setTeams', (teamData) => {
                document.getElementById('team1-info').innerHTML = `Team 1: ${teamData.team1Name} | <span class="team-points">Pünkt: 0</span> | <span class="team-x-count">X's: 0</span>`;
                document.getElementById('team2-info').innerHTML = `Team 2: ${teamData.team2Name} | <span class="team-points">Pünkt: 0</span> | <span class="team-x-count">X's: 0</span>`;
            });

            // Update team points
            socket.on('updateTeam', (teamData) => {
                const teamElement = teamData.teamName === 'Team 1' ? document.getElementById('team1-info') : document.getElementById('team2-info');
                
                const currentPoints = parseInt(teamElement.querySelector('.team-points').innerText.split('Pünkt: ')[1], 10) || 0;

                const newPointsTotal = currentPoints + teamData.points;

                teamElement.querySelector('.team-points').innerText = `Pünkt: ${newPointsTotal}`;
            });
        </script>
    </div>
</body>
</html>
